# HTTP相关问题

- ## http为何是无状态的？怎样使无状态的http变得有状态？

  ​      http是一种无状态协议，即http不会保留服务端和客户端交互的任何信息。即：**客户端上次的请求对这次没有任何影响，服务端也不会对客户端上次的请求做任何处理。**

​             要想使http变得有状态，必须提供一种能够保持http状态的技术来支持：

​             有两种技术可以做到，一种是cookie，一种是session。

###     1 -- cookie

​             cookie是在客户端维持http状态的一种机制。是在客户端的一个存储空间。当服务端向客户端做出响应之后，会生成一个sessionId并放在响应头中的setcookie中，当客户端收到响应时会将其保存在cookie中，当下次向统一服务器发出请求之后，会连同cookie发送给服务端，服务端收到后会根据信息抽取出用户信息并进行响应。

​            根据以上的过程分析，可知，cookie最初是在服务端生成的，但是在客户端进行保存。

​            有的cookie也称为cookies，当客户端要对用户隐私进行保护时，通常会对cookie进行加密，并在服务端解密。

​          在理解cookie时，可以根据字面意思来加深理解，cookie本身有曲奇饼的意思，曲奇饼通常都是小小甜甜的。当放在网络协议中，它代表了放置在客户端的一小部分用户信息，广泛应用于很多网站，当我们打开某一网站，发现浏览器上有上次登录过的我们的信息，就像吃了一块曲奇一样甜（哈哈哈哈哈哈哈。（好生硬的解释……）

###     2 -- session

​        除了可以通过cookie在浏览器保存用户信息，维持http的状态。同样可以通过session在服务端保存用户信息。

​        session的字面意思有“会话”的意思，举个栗子，当我们和别人打电话时，从拨通短话到挂断电话的过程，就可以算为一次会话。

​        当将其放入网路协议中，它又隐藏了“面向连接”，“状态保持”的意思。

​        session是在客户端第一次向服务端发出请求时生成的，当客户端访问服务器的时候，服务端将客户端信息以某种形式保存在服务端，这就是session。当客户端再次发出请求时，服务端只需要根据这个保存下的session来判断并返回响应即可。

​       虽然session保存在服务端，对客户端是透明的，但是他正常运行还需要客户端来维持，他需要使用cookie来维持状态。因为http是无状态的，无法保持客户端和服务端交互的信息，所以客户端在发出请求时，会发送一个JESSIONID的cookie，内容即为服务端发给客户端的session的Id，服务端只需根据判断session中的内容和cookie中的是否一致来判断是否请求来自同一用户。

###    3. cookie和session的区别

1.  cookie存在客户端，session存在服务端；
2.  cookie的安全性低，存放在浏览器信息可能会被窃取；session的安全性相对较好。
3.  session存放在服务器会占用服务器的性能，对服务器的性能会有所影响，当考虑到为服务器分担压力时可以考虑使用cookie。
4. cookie只能存储字符串，session可以存放任何类型的数据。
5. cookie有大小限制，单个站点的cookie大小限制为3k。

###    4.如果有的浏览器禁用cookie，session怎样判断请求是否来自同一用户？

​    如果浏览器禁用cookie，可以是用url重写技术来进行跟踪，即每次和HTTP交互，在url中加上"sessionId=。。。"来判断。

###    5.总结

​      如果说cookie是检验客户身份的“通行证”，那么session就是存放在服务端的“客户身份明细表”，每次服务端在确认身份时，只需要从明细表中检查通行证中的信息即可。